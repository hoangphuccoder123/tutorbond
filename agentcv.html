<!DOCTYPE html>
<html lang="vi">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Agent CV - Phân tích và tối ưu CV bằng AI</title>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
		<link rel="stylesheet" href="css/agentcv.css" />
		<script src="https://cdn.tailwindcss.com"></script>
	</head>
	<body class="custom-scrollbar">
		<header class="px-6 py-6">
			<div class="max-w-6xl mx-auto flex items-center justify-between">
				<div class="flex items-center gap-3">
					<div class="w-10 h-10 rounded-xl glass flex items-center justify-center animate-glow">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400">
							<path d="M12 3L9.5 8.5L4 11L9.5 13.5L12 19L14.5 13.5L20 11L14.5 8.5L12 3Z"></path>
						</svg>
					</div>
					<h1 class="text-2xl md:text-3xl font-black tracking-tight">Agent CV</h1>
				</div>
				<div class="text-sm text-slate-300 font-medium">Phân tích & tối ưu CV bằng AI</div>
			</div>
		</header>

		<main class="px-6 pb-16">
			<div class="max-w-6xl mx-auto">
				<!-- Error message -->
				<div id="error-message" class="hidden glass border border-red-500/30 text-red-300 font-medium px-4 py-3 rounded-lg mb-6"></div>

				<!-- Upload View -->
				<section id="upload-view" class="w-full">
					<div id="image-upload-container" class="glass rounded-2xl p-8 hover-lift">
						<!-- Loading state during analysis in upload view -->
						<div id="upload-loading" class="hidden items-center justify-center text-center min-h-[260px]">
							<div class="space-y-4">
								<div class="relative w-fit mx-auto">
									<svg class="animate-spin w-16 h-16 text-blue-400 spinner-glow" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
										<circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
										<path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
									</svg>
									<div class="absolute -inset-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full blur opacity-30 animate-pulse-slow"></div>
								</div>
								<p class="text-lg font-bold">AI đang xử lý ảnh CV của bạn...</p>
								<p class="text-slate-400">Vui lòng chờ trong giây lát.</p>
							</div>
						</div>

						<!-- Content when no image selected -->
						<div id="upload-content" class="space-y-6">
							<!-- Image preview -->
							<div id="image-preview-wrapper" class="hidden relative">
								<img id="image-preview" alt="Ảnh CV" class="w-full max-h-[420px] object-contain rounded-lg border border-slate-600" />
								<button id="remove-image-button" class="absolute top-4 right-4 px-3 py-2 rounded-md bg-red-600 text-white font-semibold shadow hover:brightness-110">
									Xóa ảnh
								</button>
							</div>

							<!-- Drop zone -->
							<div id="drop-zone" class="border-2 border-dashed border-slate-600 rounded-xl p-10 text-center cursor-pointer hover-glow">
								<div class="flex flex-col items-center gap-4">
									<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400 animate-float">
										<path d="M21 15a4 4 0 0 1-4 4H5a4 4 0 0 1-1-7.874M12 3v12"></path>
										<path d="m8 7 4-4 4 4"></path>
									</svg>
									<div>
										<p class="text-lg font-bold">Tải lên CV của bạn</p>
										<p class="text-slate-400">Hỗ trợ ảnh PNG hoặc file DOCX</p>
									</div>
									<button class="btn-primary text-white font-bold px-5 py-3 rounded-lg">Chọn file</button>
								</div>
								<input id="file-input" type="file" accept="image/png,.docx" class="hidden" />
							</div>
						</div>
					</div>
				</section>

				<!-- Main View after CV extracted -->
				<section id="main-view" class="hidden gap-8 mt-8">
					<!-- Left: CV Editor -->
					<div class="space-y-6">
						<div class="glass rounded-2xl p-6">
							<div class="flex items-center justify-between mb-4">
								<h2 class="text-xl md:text-2xl font-black">Chỉnh sửa CV</h2>
								<button id="reanalyze-button" class="btn-primary text-white font-bold px-5 py-3 rounded-lg flex items-center gap-2">
									<span id="reanalyze-button-text">Phân tích lại</span>
									<span id="reanalyze-button-loading" class="hidden">
										<svg class="animate-spin w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
											<circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
											<path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
										</svg>
									</span>
								</button>
							</div>
							<div id="cv-editor" class="space-y-4"></div>
						</div>
					</div>

					<!-- Right: Preview & Analysis -->
					<div class="space-y-6">
						<div class="glass rounded-2xl">
							<!-- Tabs -->
							<div class="p-4 border-b border-slate-600 flex items-center justify-between">
								<div class="flex gap-3">
									<button id="preview-tab" class="px-4 py-2 rounded-lg tab-active font-bold">Xem trước CV</button>
									<button id="analysis-tab" class="px-4 py-2 rounded-lg tab-inactive font-bold">Kết quả phân tích</button>
								</div>
								<button id="download-docx-button" class="px-4 py-2 rounded-lg font-bold bg-blue-600 text-white hover:brightness-110">Tải xuống DOCX</button>
							</div>

							<div id="result-container" class="p-6">
								<div id="cv-preview-container" class=""></div>
								<div id="analysis-result-container" class="hidden"></div>
							</div>
						</div>
					</div>
				</section>
			</div>
		</main>
        
		<!-- Library for DOCX parsing (browser) -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
		<!-- Library for client-side HTML → DOCX conversion -->
		<script src="https://unpkg.com/html-docx-js/dist/html-docx.js"></script>
		<!-- Backend script: do not modify -->
		<script type="module" src="js/agentcv.js"></script>
	</body>
</html>
